# 438. Find All Anagrams in a String

#### [link](https://www.lintcode.com/problem/find-all-anagrams-in-a-string/)

#### Description
Given two strings `s` and `p`, return an array of all the start indices of `p`'s **anagrams** in `s`. You may return the answer in **any order**.

#### Example 1:
```
Input: s = "cbaebabacd", p = "abc"
Output: [0,6]
Explanation:
The substring with start index = 0 is "cba", which is an anagram of "abc".
The substring with start index = 6 is "bac", which is an anagram of "abc".
```
#### Example 2:
```
Input: s = "abab", p = "ab"
Output: [0,1,2]
Explanation:
The substring with start index = 0 is "ab", which is an anagram of "ab".
The substring with start index = 1 is "ba", which is an anagram of "ab".
The substring with start index = 2 is "ab", which is an anagram of "ab".
```

#### Constraints:
* `1 <= s.length, p.length <= 3 * 10^4`
* `s` and `p` consist of lowercase English letters.

## Sliding Window
```java
public class Solution {
    /**
     * @param s: a string
     * @param p: a string
     * @return: a list of index
     */
    public List<Integer> findAnagrams(String s, String p) {
        if(p.length() == 0 || s.length() < p.length())
            return new ArrayList<>();
        
        int[] charToCount = new int[26];
        List<Integer> ans = new ArrayList<>();
        int nonZero = 0;
        
        for(char c : p.toCharArray()){
            charToCount[c - 'a']++;
        }
        
        for(int i = 0 ; i < p.length() ; i++){
            charToCount[s.charAt(i) - 'a']--;
        }
        
        for(int n : charToCount){
            nonZero += Math.abs(n);
        }
        
        if(nonZero == 0){
            ans.add(0);
        }
        
        for(int i = p.length() ; i < s.length() ; i++){
            int left = s.charAt(i - p.length()) - 'a';
            int right = s.charAt(i) - 'a';
            
            nonZero -= Math.abs(charToCount[left]);
            nonZero -= Math.abs(charToCount[right]);
            
            charToCount[left]++;
            charToCount[right]--;
            
            nonZero += Math.abs(charToCount[left]);
            nonZero += Math.abs(charToCount[right]);
            
            if(nonZero == 0)
                ans.add(i - p.length() + 1);
        }
        
        return ans;
    }
}
```
### Time complexity
* O(n)
### Space complexity
* O(n)
### Remark
* build charToCount mapping
* keep track of the total difference
* sliding window to update the difference  

## Two Pointers (python)
```python
class Solution:
    def findAnagrams(self, s: str, p: str) -> List[int]:
        if len(s) < len(p):
            return[]
        counts_p = defaultdict(int)
        for c in p:
            counts_p[c] += 1

        counts_s = defaultdict(int)
        ans = []
        left = 0
        for right in range(len(s)):
            # invalid character
            if counts_p[s[right]] == 0:
                left = right + 1
                counts_s = defaultdict(int)
                continue

            while counts_s[s[right]] == counts_p[s[right]]:
                counts_s[s[left]] -= 1
                left += 1
            
            counts_s[s[right]] += 1
            if right - left + 1 == len(p):
                ans.append(left)
                counts_s[s[left]] -= 1
                left += 1

        return ans
```
### Time complexity
* O(n)
### Space complexity
* O(1)

## Sliding Window (pyton)
```python
class Solution:
    def findAnagrams(self, s: str, p: str) -> List[int]:
        if len(s) < len(p):
            return[]
        counts_p = [0] * 26
        counts_s = [0] * 26
        for c in p:
            counts_p[ord(c) - ord("a")] += 1

        ans = []
        for i in range(len(s)):
            counts_s[ord(s[i]) - ord("a")] += 1
            if i >= len(p):
                counts_s[ord(s[i - len(p)]) - ord("a")] -= 1

            if counts_p == counts_s:
                ans.append(i - len(p) +1)
        return ans
```
### Time complexity
* O(n)
### Space complexity
* O(1)
### Remark
* more intuitive, just keeping the same size of window