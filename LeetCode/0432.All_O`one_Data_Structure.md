# 432. All O`one Data Structure

#### [link](https://leetcode.com/problems/XXX/)

#### Description
Design a data structure to store the strings' count with the ability to return the strings with minimum and maximum counts.

Implement the `AllOne` class:

* `AllOne()` Initializes the object of the data structure.
* `inc(String key)` Increments the count of the string `key` by `1`. If `key` does not exist in the data structure, insert it with count `1`.
* `dec(String key)` Decrements the count of the string `key` by `1`. If the count of `key` is `0` after the decrement, remove it from the data structure. It is guaranteed that key exists in the data structure before the decrement.
* `getMaxKey()` Returns one of the keys with the maximal count. If no element exists, return an empty string `""`.
* `getMinKey()` Returns one of the keys with the minimum count. If no element exists, return an empty string `""`.

**Note** that each function must run in `O(1)` average time complexity.

#### Example 1:
```
Input
["AllOne", "inc", "inc", "getMaxKey", "getMinKey", "inc", "getMaxKey", "getMinKey"]
[[], ["hello"], ["hello"], [], [], ["leet"], [], []]
Output
[null, null, null, "hello", "hello", null, "hello", "leet"]

Explanation
AllOne allOne = new AllOne();
allOne.inc("hello");
allOne.inc("hello");
allOne.getMaxKey(); // return "hello"
allOne.getMinKey(); // return "hello"
allOne.inc("leet");
allOne.getMaxKey(); // return "hello"
allOne.getMinKey(); // return "leet"
```

#### Constraints:
* `1 <= key.length <= 10`
* `key` consists of lowercase English letters.
* It is guaranteed that for each call to `dec`, `key` is existing in the data structure.
* At most `5 * 10^4` calls will be made to `inc`, `dec`, `getMaxKey`, and `getMinKey`.

## Doubly Linked List
```python
class Node:
    def __init__(self, freq):
        self.freq = freq
        self.prev = None
        self.next = None
        self.keys = set()

class AllOne:

    def __init__(self):
        self.head = Node(-1)
        self.tail = Node(-1)
        self.head.next = self.tail
        self.tail.prev = self.head
        self.map = {}

    def inc(self, key: str) -> None:
        if key not in self.map:
            if self.head.next.freq == 1:
                node_now = self.head.next
            else:
                node_now = Node(1)
                self._insert(self.head, self.head.next, node_now)
            node_now.keys.add(key)
            self.map[key] = node_now
        else:
            node_ori = self.map[key]
            node_ori.keys.remove(key)
            if node_ori.next.freq == node_ori.freq + 1:
                node_now = node_ori.next
            else:
                node_now = Node(node_ori.freq + 1)
                self._insert(node_ori, node_ori.next, node_now)
            node_now.keys.add(key)
            self.map[key] = node_now
            self._clean(node_ori)

    def dec(self, key: str) -> None:
        node_ori = self.map[key]
        node_ori.keys.remove(key)
        if node_ori.freq > 1:
            if node_ori.prev.freq == node_ori.freq - 1:
                node_now = node_ori.prev
            else:
                node_now = Node(node_ori.freq - 1)
                self._insert(node_ori.prev, node_ori, node_now)
            node_now.keys.add(key)
            self.map[key] = node_now
        else:
            del self.map[key]
        self._clean(node_ori)

    def _insert(self, prev_node, next_node, now_node):
        prev_node.next = now_node
        now_node.next = next_node
        next_node.prev = now_node
        now_node.prev = prev_node

    def _clean(self, node):
        if not node.keys:
            prev_node = node.prev
            next_node = node.next
            prev_node.next = next_node
            next_node.prev = prev_node

    def getMaxKey(self) -> str:
        if self.head.next == self.tail:
            return ""
        return next(iter(self.tail.prev.keys))

    def getMinKey(self) -> str:
        if self.head.next == self.tail:
            return ""
        return next(iter(self.head.next.keys))


# Your AllOne object will be instantiated and called as such:
# obj = AllOne()
# obj.inc(key)
# obj.dec(key)
# param_3 = obj.getMaxKey()
# param_4 = obj.getMinKey()
```
### Time complexity
* O(1)
### Space complexity
* O(n), number of unique keys
### Remark